@model AdminDashboard.Models.PackageModel
@{
    ViewData["Title"] = "Create Package";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<div class="col-lg-9 col-md-12 px-4 mt-3">

    <h1>
        Create Package
    </h1>
    <form asp-action="Create" asp-controller="Packages" class="row g-3 mt-5" enctype="multipart/form-data">
        <div class="col-md-6">
            <label for="Name" class="form-label">@Html.DisplayNameFor(x=>x.Name):</label>
            <input asp-for="Name" class="form-control" name="Name" id="Name" />
        </div>
        <div class="col-md-2">
            <label for="Price" class="form-label">@Html.DisplayNameFor(x=>x.Price):</label>
            <input asp-for="Price" class="form-control" name="Price" id="Price" type="number" />
        </div>
        <div class="col-md-2">
            <label for="Discount" class="form-label">@Html.DisplayNameFor(x=>x.Discount):</label>
            <input asp-for="Discount" class="form-control" name="Discount" id="Price" type="number" />
        </div>
        <div class="col-md-6">
            <label for="Description" class="form-label">@Html.DisplayNameFor(x=>x.Description):</label>
            <textarea asp-for="Description" class="form-control" id="Description"></textarea>
        </div>
        <div class="col-md-2">
            <label for="NumberOfDays" class="form-label">@Html.DisplayNameFor(x=>x.NumberOfDays):</label>
            <input asp-for="NumberOfDays" class="form-control" name="NumberOfDays" id="NumberOfDays" type="number" />
        </div>
        <div class="col-md-2">
            <label for="NumberOfNights" class="form-label">@Html.DisplayNameFor(x=>x.NumberOfNights):</label>
            <input asp-for="NumberOfNights" class="form-control" name="NumberOfNights" id="Price" type="number" />
        </div>
        <div class="col-lg-4 mb-2">
            <label for="PackageTypeId" class="form-label">Package Type</label>
            <select id="PackageTypeId" class="form-select">
                @foreach (var type in ViewBag.PackageTypes)
                {
                    <option value="@type.Value">@type.Text</option>
                }
            </select>
        </div>
        <div class="col-lg-4 mb-2">
            <label for="RoomClassId" class="form-label">Hotel Room Class</label>
            <select id="RoomClassId" class="form-select">
                @foreach (var roomClass in ViewBag.RoomClass)
                {
                    <option value="@roomClass.Value">@roomClass.Text</option>
                }
            </select>
        </div>
        <div class="mb-3">
            <label for="formFile" class="form-label">Upload Main Image</label>
            <input asp-for="PackageMainImageFile" class="form-control" id="PackageMainImageFile" />
        </div>
        <div class="mb-3">
            <label for="formFileMultiple" class="form-label">Upload Multiple Images</label>
            <input asp-for="PackageImages" class="form-control" id="PackageImages" multiple onchange="limitAndHandleFileSelection(this, 3)"/>
        </div>
        <h2>About The Package</h2>
        <div>
            <button class="btn1" style="border: none;" onclick="addDay(event)"><i class='bx bx-message-square-add'></i> Add Day</button>
            <h5 class="mt-4">Use a mark (//) to separate lines in the Description.</h5>
        </div>


        <div id="dayContainer">
            <h5>Day 1</h5>
            <div class="col-md-4">
                <label for="inputEmail4" class="form-label">Title</label>
                <input type="text" class="form-control" id="inputEmail4">
            </div>
            <div class="col-md-6">
                <label for="inputCity" class="form-label">Description</label>
                <textarea type="text" class="form-control" id="inputCity"></textarea>
            </div>
            <div class="col-md-2">
                <label for="cities" class="form-label">City</label>
                <select id="RoomClassId" class="form-select">
                    @{
                    foreach(var city in ViewBag.Cities)
                    {
                        <option value="@city.Value" id="city1">@city.Text</option>
                    }
                }
                </select>
            </div>
        </div>
        <div class="col-12">
            <label for="IsPublished" class="form-label">@Html.DisplayNameFor(x=>x.IsPublished):</label>
            <div class="col-sm-10">
                <div class="form-check">
                    <input asp-for="IsPublished" class="form-check-input" type="checkbox" name="IsPublished" id="IsPublished" />
                </div>
            </div>
        </div>

        <div class="col-12">
            <button type="submit" class="btn btn-primary">Submit</button>
        </div>
    </form>
</div>
<script>

    function limitFileSelection(input, maxCount) {
        if (input.files.length > maxCount) {
            input.value = "";
            alert("You can only upload a maximum of " + maxCount + " files");
        }
    }

    var dayCounter = 2; 
    function addDay(event) {

        event.preventDefault();

        var dayTitle = document.createElement("h5");
        dayTitle.textContent = "Day " + dayCounter;

        var titleDiv = document.createElement("div");
        titleDiv.classList.add("col-md-4");

        var titleLabel = document.createElement("label");
        titleLabel.classList.add("form-label");
        titleLabel.textContent = "Title";
        titleLabel.setAttribute("for", "inputEmail" + dayCounter); 
        titleDiv.appendChild(titleLabel);

        var titleInput = document.createElement("input");
        titleInput.type = "text";
        titleInput.classList.add("form-control");
        titleInput.id = "inputEmail" + dayCounter;
        titleDiv.appendChild(titleInput);

        var descriptionDiv = document.createElement("div");
        descriptionDiv.classList.add("col-md-6");

        var descriptionLabel = document.createElement("label");
        descriptionLabel.classList.add("form-label");
        descriptionLabel.textContent = "Description";
        descriptionLabel.setAttribute("for", "inputCity" + dayCounter); 
        descriptionDiv.appendChild(descriptionLabel);

        var descriptionTextarea = document.createElement("textarea");
        descriptionTextarea.type = "text";
        descriptionTextarea.classList.add("form-control");
        descriptionTextarea.id = "inputCity" + dayCounter;
        descriptionDiv.appendChild(descriptionTextarea);

        // var citiesDiv = document.createElement("div");
        // citiesDiv.classList.add("col-md-2");
        // var selectList = document.createElement("select");
        // selectList.id = "cities" + dayCounter;
        // selectList.classList.add("form-select");
        // foreach(var city in @ViewBag.Cities)
        // {
        //     var option = document.createElement("option");
        //     option.value = city.Value;
        //     option.text = city.Text;
        //     option.id = "city" + dayCounter;
        //     selectList.appendChild(option);
        // }

        // citiesDiv.appendChild(selectList));


        var dayContainer = document.getElementById("dayContainer");
        dayContainer.appendChild(dayTitle);
        dayContainer.appendChild(titleDiv);
        dayContainer.appendChild(descriptionDiv);
        // dayContainer.appendChild(citiesDiv);

        dayCounter++;
    }

    function limitAndHandleFileSelection(input, maxCount) {
        // Call the original limitFileSelection function to limit the number of selected files
        limitFileSelection(input, maxCount);

        // Get the selected files
        var files = input.files;

        // Initialize an array to store JSON objects
        var imageArray = [];

        // Loop through the selected files
        for (var i = 0; i < files.length; i++) {
            var file = files[i];

            // Create a JSON object for each file
            var imageObject = {
                fileName: file.name,
                fileSize: file.size,
                fileType: file.type
                // You can add more properties based on your requirements
            };

            // Add the JSON object to the array
            imageArray.push(imageObject);
        }

        // Display the array of JSON objects in the console (you can modify this part based on your needs)
        console.log(imageArray);
    }

    function limitFileSelection(input, maxCount) {
        if (input.files.length > maxCount) {
            input.value = "";
            alert("You can only upload a maximum of " + maxCount + " files");
        }
    }
</script>